<% content_for(:title) { "Søgning: “#{params[:q]}”" } %>

<header class="margin-top-double text-align-center">
  <h1><%= content_for :title %></h1>
</header>


<div class="centered">
  <%= form_with url: search_path, method: :get do |form| %>
    <%= form.search_field :q, value: params[:q] %>
    
    <fieldset>
      <legend>Sagstyper</legend>
      <%= form.collection_check_boxes(:sagstyper, Oda::Sagstype.top, :id, :typenavn, checked: params[:sagstyper]) do |type| %>
        <p>
          <%= type.checkbox %>
          <%= type.label %>
        </p>
      <% end %>
      <details>
        <summary class="hide-when-open">Flere</summary>
        <%= form.collection_check_boxes(:sagstyper, Oda::Sagstype.bottom, :id, :typenavn, checked: params[:sagstyper]) do |type| %>
        <p>
          <%= type.checkbox %>
          <%= type.label %>
        </p>
      <% end %>
      </details>
    </fieldset>


    <%= form.submit "Søg" %>
  <% end %>

<!--
  <p class="marign-top"> 
    <%= link_to "Opret søgeagent", new_search_agent_path %>
  </p>
-->

  <ol class="flex column gap margin-top-double">
    <% @page.records.each do |sag| %>
      <li>
        <strong><%= sag.nummer %></strong>: <%= link_to highlight(sag.titelkort, params[:q]), oda_case_path(sag), title: sag.titel %>
        <p><%= highlighted_excerpt(sag.titel, params[:q]) %></p>
        <strong><%= sag.status.status %></strong>
      </li>
    <% end %>
  </ol>
</div>

<%= render partial: 'oda/pagination' %>
